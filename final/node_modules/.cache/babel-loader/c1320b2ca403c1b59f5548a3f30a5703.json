{"ast":null,"code":"import _asyncToGenerator from\"C:\\\\vscode\\\\webfinalproject\\\\final\\\\final\\\\final\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _slicedToArray from\"C:\\\\vscode\\\\webfinalproject\\\\final\\\\final\\\\final\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _taggedTemplateLiteral from\"C:\\\\vscode\\\\webfinalproject\\\\final\\\\final\\\\final\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\taggedTemplateLiteral.js\";var _templateObject;import _regeneratorRuntime from\"C:\\\\vscode\\\\webfinalproject\\\\final\\\\final\\\\final\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import Chart from'react-apexcharts';import React from'react';import{Tabs,Button,Space,Input,Typography,message,DatePicker}from'antd';import moment from\"moment\";import'../Css/PieGraph.css';import axios from'../axios.js';import{useState,useEffect}from'react';import RingLoader from'react-spinners/RingLoader.js';import{css}from\"@emotion/react\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TabPane=Tabs.TabPane;var Search=Input.Search;var Title=Typography.Title;var override=css(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: block;\\n  margin: -20%;\\n  border-color: #971d1d;\\n\"])));var Graph=function Graph(_ref){var username=_ref.username;var _useState=useState(moment()),_useState2=_slicedToArray(_useState,2),Date=_useState2[0],setDate=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),labels=_useState4[0],setLabels=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),series=_useState6[0],setSeries=_useState6[1];var _useState7=useState(\"??��??\"),_useState8=_slicedToArray(_useState7,2),status=_useState8[0],setStatus=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),loading2=_useState10[0],setLoading2=_useState10[1];var getdata=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var YM,_yield$axios$get,NewRecords;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:YM=Date.format(\"YYYY-MM\");_context.next=3;return axios.get('/api/GetPieInformation',{// get backend\nparams:{username:username,// give backend\nYM:YM,status:status}});case 3:_yield$axios$get=_context.sent;NewRecords=_yield$axios$get.data.NewRecords;return _context.abrupt(\"return\",NewRecords);case 6:case\"end\":return _context.stop();}}},_callee);}));return function getdata(){return _ref2.apply(this,arguments);};}();var HandleChange=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var position,templabels,tempseries,NewRecords,_loop,i;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLoading2(function(loading){return!loading;});setLabels([]);setSeries([]);position={};templabels=new Set();tempseries=[];_context2.next=8;return getdata();case 8:NewRecords=_context2.sent;console.log(NewRecords);_loop=function _loop(i){var Type=NewRecords[i].type;var cost=NewRecords[i].cost;if(!templabels.has(Type)){templabels.add(Type);position.Type=templabels.size-1;tempseries.push(cost);}else{tempseries=tempseries.map(function(item,index){if(index===position.Type)return item+=cost;else return item;});}};for(i=0;i<NewRecords.length;i++){_loop(i);}setLabels(Array.from(templabels));setSeries(tempseries);setLoading2(function(loading){return!loading;});case 15:case\"end\":return _context2.stop();}}},_callee2);}));return function HandleChange(){return _ref3.apply(this,arguments);};}();useEffect(function(){HandleChange();//console.log(loading2);\n},[status,Date]);var options={chart:{animation:{enabled:true,speed:100,animateGradually:{enabled:true,delay:500}}},noData:{text:\" There is no record in this Month\",align:'center',verticalAlign:'middle',offsetX:0,offsetY:-200,style:{color:\"red\",fontSize:'30px',fontFamily:\"sans-serif\"}},legend:{position:'bottom',fontSize:\"20%\"},labels:labels};return loading2?/*#__PURE__*/_jsx(\"div\",{style:{position:\"fixed\",top:\"50%\",left:\"50%\",transform:\"translate(-50%, -50%)\"},children:/*#__PURE__*/_jsx(RingLoader,{color:\"#971d1d\",css:override,size:100})}):/*#__PURE__*/_jsxs(Tabs,{defaultActiveKey:status,centered:true,onTabClick:function onTabClick(key){return setStatus(key);},children:[/*#__PURE__*/_jsxs(TabPane,{tab:\"??\\uFFFD\\uFFFD??\",children:[/*#__PURE__*/_jsx(DatePicker,{size:\"large\",value:Date,picker:\"month\",onChange:function onChange(date){setDate(date);},allowClear:false}),/*#__PURE__*/_jsx(\"div\",{className:\"pie\",children:/*#__PURE__*/_jsx(Chart,{options:options,type:\"pie\",series:series,width:\"500\",height:\"1000\"})})]},\"??��??\"),/*#__PURE__*/_jsxs(TabPane,{tab:\"??\\uFFFD\\uFFFD??\",children:[/*#__PURE__*/_jsx(DatePicker,{size:\"large\",value:Date,picker:\"month\",onChange:function onChange(date){setDate(date);},allowClear:false}),/*#__PURE__*/_jsx(\"div\",{className:\"pie\",children:/*#__PURE__*/_jsx(Chart,{options:options,type:\"pie\",series:series,width:\"500\",height:\"1000\"})})]},\"??��??\")]});};export default Graph;","map":{"version":3,"sources":["C:/vscode/webfinalproject/final/final/final/src/Containers/PieChart.js"],"names":["Chart","React","Tabs","Button","Space","Input","Typography","message","DatePicker","moment","axios","useState","useEffect","RingLoader","css","TabPane","Search","Title","override","Graph","username","Date","setDate","labels","setLabels","series","setSeries","status","setStatus","loading2","setLoading2","getdata","YM","format","get","params","NewRecords","data","HandleChange","loading","position","templabels","Set","tempseries","console","log","i","Type","type","cost","has","add","size","push","map","item","index","length","Array","from","options","chart","animation","enabled","speed","animateGradually","delay","noData","text","align","verticalAlign","offsetX","offsetY","style","color","fontSize","fontFamily","legend","top","left","transform","key","date"],"mappings":"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","sourcesContent":["import Chart from 'react-apexcharts'\r\nimport React from 'react';\r\nimport { Tabs, Button, Space, Input, Typography, message, DatePicker } from 'antd';\r\nimport moment from \"moment\";\r\nimport '../Css/PieGraph.css'\r\nimport axios from '../axios.js'\r\nimport { useState, useEffect } from 'react';\r\nimport RingLoader from 'react-spinners/RingLoader.js'\r\nimport { css } from \"@emotion/react\";\r\nconst { TabPane } = Tabs;\r\nconst { Search } = Input;\r\nconst { Title } = Typography;\r\n\r\nconst override = css`\r\n  display: block;\r\n  margin: -20%;\r\n  border-color: #971d1d;\r\n`;\r\nconst Graph = ({ username }) => {\r\n    const [Date, setDate] = useState(moment())\r\n    const [labels, setLabels] = useState([]);\r\n    const [series, setSeries] = useState([]);\r\n    const [status, setStatus] = useState(\"??��??\");\r\n    const [loading2, setLoading2] = useState(false);\r\n    const getdata = async () => {\r\n        const YM = Date.format(\"YYYY-MM\")\r\n        const { data: { NewRecords } } = await axios.get('/api/GetPieInformation', { // get backend\r\n            params: {\r\n                username, // give backend\r\n                YM,\r\n                status\r\n            },\r\n        })\r\n        //console.log(YM);\r\n        return NewRecords;\r\n    }\r\n    const HandleChange = async () => {\r\n        setLoading2((loading) => !loading)\r\n        setLabels([]);\r\n        setSeries([]);\r\n        let position = {};\r\n        let templabels = new Set();\r\n        let tempseries = [];\r\n\r\n        const NewRecords = await getdata();\r\n        console.log(NewRecords)\r\n        for (let i = 0; i < NewRecords.length; i++) {\r\n            let Type = NewRecords[i].type\r\n            let cost = NewRecords[i].cost\r\n            if (!templabels.has(Type)) {\r\n                templabels.add(Type);\r\n                position.Type = templabels.size - 1;\r\n                tempseries.push(cost);\r\n            }\r\n            else {\r\n                tempseries = tempseries.map((item, index) => {\r\n                    if (index === position.Type) return item += cost\r\n                    else return item\r\n                })\r\n            }\r\n        }\r\n        setLabels(Array.from(templabels));\r\n        setSeries(tempseries)\r\n        setLoading2((loading) => !loading)\r\n    }\r\n    useEffect(() => {\r\n        HandleChange();\r\n        //console.log(loading2);\r\n    }, [status, Date])\r\n    var options = {\r\n        chart: {\r\n            animation: {\r\n                enabled: true,\r\n                speed: 100,\r\n                animateGradually: {\r\n                    enabled: true,\r\n                    delay: 500\r\n                },\r\n            }\r\n        },\r\n        noData: {\r\n            text: \" There is no record in this Month\",\r\n            align: 'center',\r\n            verticalAlign: 'middle',\r\n            offsetX: 0,\r\n            offsetY: -200,\r\n            style: {\r\n                color: \"red\",\r\n                fontSize: '30px',\r\n                fontFamily: \"sans-serif\"\r\n            }\r\n        },\r\n        legend: {\r\n            position: 'bottom',\r\n            fontSize: \"20%\"\r\n        },\r\n        labels: labels\r\n    };\r\n\r\n    return loading2 ? (\r\n        <div style={{ position: \"fixed\", top: \"50%\", left: \"50%\", transform: \"translate(-50%, -50%)\" }}>\r\n            <RingLoader color=\"#971d1d\" css={override} size={100} />\r\n        </div>) : (\r\n        <Tabs defaultActiveKey={status} centered onTabClick={(key) => setStatus(key)}>\r\n            <TabPane tab=\"??��??\" key=\"??��??\">\r\n                <DatePicker size=\"large\" value={Date} picker=\"month\" onChange={(date) => { setDate(date) }} allowClear={false} />\r\n                <div className='pie'>\r\n                    {/*<Button  type='primary' onClick={()=>{HandleChange()}}> 確�?? </Button>*/}\r\n                    <Chart options={options} type=\"pie\" series={series} width=\"500\" height='1000' />\r\n                </div>\r\n            </TabPane>\r\n            <TabPane tab=\"??��??\" key=\"??��??\">\r\n                <DatePicker size=\"large\" value={Date} picker=\"month\" onChange={(date) => { setDate(date) }} allowClear={false} />\r\n                <div className='pie'>\r\n                    {/*<Button  type='primary' onClick={()=>{HandleChange()}}> 確�?? </Button>*/}\r\n                    <Chart options={options} type='pie' series={series} width=\"500\" height='1000' />\r\n                </div>\r\n            </TabPane>\r\n        </Tabs>\r\n    )\r\n}\r\nexport default Graph"]},"metadata":{},"sourceType":"module"}